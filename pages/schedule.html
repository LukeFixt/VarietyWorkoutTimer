<h1>Schedule</h1>
<p class="text-warning background-dark p-2">Waste of time, not needed - User can use their own calendar to schedule</p>
<div id="calendar" class="table-container">
  <table>
    <thead>
    </thead>
    <tbody>
    </tbody>
  </table>
</div>

<script>
  let weekStart = 1;

  let week = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

  if (weekStart > 0) {
    for (let i = 0; i < weekStart; i++) {
      week.push(week.shift());
    }
  }

  $('#calendar thead').html(() => {
    html = ''
    week.forEach(day => {
      html += `<th>${day}</th>`;
    })
    return html;
  });

  function getDaysInMonthUTC(month, year) {
  let date = new Date(Date.UTC(year, month, 1));
  let days = [];
  while (date.getUTCMonth() === month) {
    days.push(new Date(date));
    date.setUTCDate(date.getUTCDate() + 1);
  }
  return days;
}
  let today = new Date();
  let month = getDaysInMonthUTC(today.getMonth(),today.getFullYear());

  firstDay = month[0];
  offset = (7 + firstDay.getDay() - weekStart) % 7;
  console.log(offset)
  for (let i = 0; i < offset; i++) {
    yesterday = new Date(firstDay);
    month.unshift(new Date(yesterday.setDate(yesterday.getDate() - (i+1))));
  }
  
  lastDay = month[month.length-1];
  offset = 7 - month.length % 7;
  for (let i = 0; i < offset; i++) {
    tomorrow = new Date(lastDay);
    month.push(new Date(tomorrow.setDate(tomorrow.getDate() + (i+1))));
  }

  month = month.reduce((all,one,i) => {
    const ch = Math.floor(i/7); 
    all[ch] = [].concat((all[ch]||[]),one);
    return all
  }, [])

  $('#calendar tbody').html(() => {
    html = '';
    month.forEach(week => {
      html += '<tr>';
      week.forEach(day => {
        monthName = ''
        c = '';
        if(day.getMonth() != today.getMonth()){
          c = ' disabled';
          monthName = day.toLocaleString('default', { month: 'short' }) + ' ';
        }
        if(day.getDate() == today.getDate()){
          c = ' class="today"';
        }
        html += `<td${c}>${monthName}${day.getDate()}<div><button>Add Workout</button></div></td>`;
      })
      html += '</tr>';
    })
    return html;
  });
</script>